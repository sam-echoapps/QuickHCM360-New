/**
 * @license
 * Ideal Postcodes <https://ideal-postcodes.co.uk>
 * Copyright IDDQD Limited
 * Postcode Lookup Bundled 2.2.7
 * Built on Postcode Lookup ~1.10.0
 * AGPL-3.0 Licence
 */
function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?e(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const o={tls:!0,api_key:"",baseUrl:"api.ideal-postcodes.co.uk",version:"v1",strictAuthorisation:!1,timeout:1e4,header:{Accept:"application/json","Content-Type":"application/json"},tags:[],agent:{}};const r=e=>void 0===e?{}:Object.keys(e).reduce(((t,n)=>{const o=e[n],r=i(o);return r.length>0&&(t[n]=r),t}),{}),s=e=>"string"==typeof e,i=e=>{const t=[];return n=e,Array.isArray(n)?(e.forEach((e=>{a(e)&&t.push(e.toString()),s(e)&&t.push(e)})),t.join(",")):a(e)?e.toString():s(e)?e:"";var n},a=e=>"number"==typeof e,c=(e,t)=>{let{timeout:n}=e;return a(n)?n:t.config.timeout},u=(e,n)=>{let{header:o={}}=e;return t(t({},n.config.header),r(o))},l=e=>{let{header:t,options:n,client:o}=e;return t.Authorization=((e,t)=>{const n=[],o=t.api_key||e.config.api_key;n.push(["api_key",o]);const r=t.licensee;void 0!==r&&n.push(["licensee",r]);const s=t.user_token;return void 0!==s&&n.push(["user_token",s]),"IDEALPOSTCODES ".concat(d(n))})(o,n),t},d=e=>e.map((e=>{let[t,n]=e;return"".concat(t,'="').concat(n,'"')})).join(" "),h=e=>{let{header:t,options:n}=e;const{sourceIp:o}=n;return void 0!==o&&(t["IDPC-Source-IP"]=o),t},p=e=>{let{query:t,options:n}=e;const{filter:o}=n;return void 0!==o&&(t.filter=o.join(",")),t},f=e=>{let t,{client:n,query:o,options:r}=e;return n.config.tags.length&&(t=n.config.tags),r.tags&&(t=r.tags),void 0!==t&&(o.tags=t.join(",")),o};class m extends Error{constructor(e){const t=new.target.prototype;super(),this.__proto__=t;const{message:n,httpStatus:o,metadata:r={}}=e;this.message=n,this.name="Ideal Postcodes Error",this.httpStatus=o,this.metadata=r,Error.captureStackTrace&&Error.captureStackTrace(this,m)}}class g extends m{constructor(e){super({httpStatus:e.httpStatus,message:e.body.message}),this.response=e}}class y extends g{}class v extends g{}class b extends v{}class w extends g{}class E extends w{}class C extends w{}class S extends g{}class A extends S{}class x extends S{}class O extends S{}class k extends S{}class j extends g{}const T=e=>{const{httpStatus:t,body:n}=e;if((o=t)<200||o>=300){var o;if((e=>{return null!==(t=e)&&"object"==typeof t&&"string"==typeof e.message&&"number"==typeof e.code;var t})(n)){const{code:o}=n;if(4010===o)return new b(e);if(4040===o)return new A(e);if(4042===o)return new x(e);if(4044===o)return new O(e);if(4046===o)return new k(e);if(4020===o)return new E(e);if(4021===o)return new C(e);if(404===t)return new S(e);if(400===t)return new y(e);if(402===t)return new w(e);if(401===t)return new v(e);if(500===t)return new j(e)}return new m({httpStatus:t,message:JSON.stringify(n)})}};var L=Object.freeze({__proto__:null,IdealPostcodesError:m,IdpcApiError:g,IdpcBadRequestError:y,IdpcUnauthorisedError:v,IdpcInvalidKeyError:b,IdpcRequestFailedError:w,IdpcBalanceDepletedError:E,IdpcLimitReachedError:C,IdpcResourceNotFoundError:S,IdpcPostcodeNotFoundError:A,IdpcKeyNotFoundError:x,IdpcUdprnNotFoundError:O,IdpcUmprnNotFoundError:k,IdpcServerError:j,parse:T});const P=(e,t)=>[e.client.url(),e.resource,encodeURIComponent(t),e.action].filter((e=>void 0!==e)).join("/"),q=e=>{const{client:t}=e;return(n,o)=>t.config.agent.http({method:"GET",url:P(e,n),query:r(o.query),header:u(o,t),timeout:c(o,t)}).then((e=>{const t=T(e);if(t)throw t;return e}))},_=(e,t)=>(e=>{const{client:t,resource:n}=e;return e=>t.config.agent.http({method:"GET",url:"".concat(t.url(),"/").concat(n),query:r(e.query),header:u(e,t),timeout:c(e,t)}).then((e=>{const t=T(e);if(t)throw t;return e}))})({resource:"addresses",client:e})(t),I=e=>{const t=N(e),{page:n}=e;return void 0!==n&&(t.query.page=n.toString()),(o=e.client,r=e.postcode,s=t,q({resource:"postcodes",client:o})(r,s)).then((e=>e.body.result)).catch((e=>{if(e instanceof A)return[];throw e}));var o,r,s},N=e=>{const t={},n={},{client:o}=e;l({client:o,header:t,options:e}),h({header:t,options:e}),p({query:n,options:e}),f({client:o,query:n,options:e});const r={header:t,query:n};return void 0!==e.timeout&&(r.timeout=e.timeout),r},B=e=>{const{client:t,timeout:n}=e,o=e.api_key||e.client.config.api_key,{licensee:r}=e;let s;s=void 0===r?{}:{licensee:r};const i={query:s,header:{}};return void 0!==n&&(i.timeout=n),((e,t,n)=>q({resource:"keys",client:e})(t,n))(t,o,i).then((e=>e.body.result))};var R={exports:{}},U=function(e,t){return function(){for(var n=new Array(arguments.length),o=0;o<n.length;o++)n[o]=arguments[o];return e.apply(t,n)}},F=U,D=Object.prototype.toString;function M(e){return"[object Array]"===D.call(e)}function H(e){return void 0===e}function G(e){return null!==e&&"object"==typeof e}function z(e){if("[object Object]"!==D.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function K(e){return"[object Function]"===D.call(e)}function J(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),M(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}var W={isArray:M,isArrayBuffer:function(e){return"[object ArrayBuffer]"===D.call(e)},isBuffer:function(e){return null!==e&&!H(e)&&null!==e.constructor&&!H(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:G,isPlainObject:z,isUndefined:H,isDate:function(e){return"[object Date]"===D.call(e)},isFile:function(e){return"[object File]"===D.call(e)},isBlob:function(e){return"[object Blob]"===D.call(e)},isFunction:K,isStream:function(e){return G(e)&&K(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:J,merge:function e(){var t={};function n(n,o){z(t[o])&&z(n)?t[o]=e(t[o],n):z(n)?t[o]=e({},n):M(n)?t[o]=n.slice():t[o]=n}for(var o=0,r=arguments.length;o<r;o++)J(arguments[o],n);return t},extend:function(e,t,n){return J(t,(function(t,o){e[o]=n&&"function"==typeof t?F(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}},$=W;function X(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var V=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if($.isURLSearchParams(t))o=t.toString();else{var r=[];$.forEach(t,(function(e,t){null!=e&&($.isArray(e)?t+="[]":e=[e],$.forEach(e,(function(e){$.isDate(e)?e=e.toISOString():$.isObject(e)&&(e=JSON.stringify(e)),r.push(X(t)+"="+X(e))})))})),o=r.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e},Y=W;function Q(){this.handlers=[]}Q.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},Q.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Q.prototype.forEach=function(e){Y.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var Z=Q,ee=W,te=function(e){return!(!e||!e.__CANCEL__)},ne=W,oe=function(e,t,n,o,r){return e.config=t,n&&(e.code=n),e.request=o,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},re=function(e,t,n,o,r){var s=new Error(e);return oe(s,t,n,o,r)},se=re,ie=W,ae=ie.isStandardBrowserEnv()?{write:function(e,t,n,o,r,s){var i=[];i.push(e+"="+encodeURIComponent(t)),ie.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),ie.isString(o)&&i.push("path="+o),ie.isString(r)&&i.push("domain="+r),!0===s&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},ce=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},ue=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},le=W,de=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],he=W,pe=he.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var o=e;return t&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=he.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0},fe=W,me=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(se("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)},ge=ae,ye=V,ve=function(e,t){return e&&!ce(t)?ue(e,t):t},be=function(e){var t,n,o,r={};return e?(le.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=le.trim(e.substr(0,o)).toLowerCase(),n=le.trim(e.substr(o+1)),t){if(r[t]&&de.indexOf(t)>=0)return;r[t]="set-cookie"===t?(r[t]?r[t]:[]).concat([n]):r[t]?r[t]+", "+n:n}})),r):r},we=pe,Ee=re,Ce=function(e){return new Promise((function(t,n){var o=e.data,r=e.headers;fe.isFormData(o)&&delete r["Content-Type"];var s=new XMLHttpRequest;if(e.auth){var i=e.auth.username||"",a=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";r.Authorization="Basic "+btoa(i+":"+a)}var c=ve(e.baseURL,e.url);if(s.open(e.method.toUpperCase(),ye(c,e.params,e.paramsSerializer),!0),s.timeout=e.timeout,s.onreadystatechange=function(){if(s&&4===s.readyState&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))){var o="getAllResponseHeaders"in s?be(s.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?s.response:s.responseText,status:s.status,statusText:s.statusText,headers:o,config:e,request:s};me(t,n,r),s=null}},s.onabort=function(){s&&(n(Ee("Request aborted",e,"ECONNABORTED",s)),s=null)},s.onerror=function(){n(Ee("Network Error",e,null,s)),s=null},s.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(Ee(t,e,"ECONNABORTED",s)),s=null},fe.isStandardBrowserEnv()){var u=(e.withCredentials||we(c))&&e.xsrfCookieName?ge.read(e.xsrfCookieName):void 0;u&&(r[e.xsrfHeaderName]=u)}if("setRequestHeader"in s&&fe.forEach(r,(function(e,t){void 0===o&&"content-type"===t.toLowerCase()?delete r[t]:s.setRequestHeader(t,e)})),fe.isUndefined(e.withCredentials)||(s.withCredentials=!!e.withCredentials),e.responseType)try{s.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&s.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){s&&(s.abort(),n(e),s=null)})),o||(o=null),s.send(o)}))},Se=W,Ae=function(e,t){ne.forEach(e,(function(n,o){o!==t&&o.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[o])}))},xe={"Content-Type":"application/x-www-form-urlencoded"};function Oe(e,t){!Se.isUndefined(e)&&Se.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var ke,je={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(ke=Ce),ke),transformRequest:[function(e,t){return Ae(t,"Accept"),Ae(t,"Content-Type"),Se.isFormData(e)||Se.isArrayBuffer(e)||Se.isBuffer(e)||Se.isStream(e)||Se.isFile(e)||Se.isBlob(e)?e:Se.isArrayBufferView(e)?e.buffer:Se.isURLSearchParams(e)?(Oe(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):Se.isObject(e)?(Oe(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};je.headers={common:{Accept:"application/json, text/plain, */*"}},Se.forEach(["delete","get","head"],(function(e){je.headers[e]={}})),Se.forEach(["post","put","patch"],(function(e){je.headers[e]=Se.merge(xe)}));var Te=je,Le=W,Pe=function(e,t,n){return ee.forEach(n,(function(n){e=n(e,t)})),e},qe=te,_e=Te;function Ie(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var Ne=W,Be=function(e,t){t=t||{};var n={},o=["url","method","data"],r=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],i=["validateStatus"];function a(e,t){return Ne.isPlainObject(e)&&Ne.isPlainObject(t)?Ne.merge(e,t):Ne.isPlainObject(t)?Ne.merge({},t):Ne.isArray(t)?t.slice():t}function c(o){Ne.isUndefined(t[o])?Ne.isUndefined(e[o])||(n[o]=a(void 0,e[o])):n[o]=a(e[o],t[o])}Ne.forEach(o,(function(e){Ne.isUndefined(t[e])||(n[e]=a(void 0,t[e]))})),Ne.forEach(r,c),Ne.forEach(s,(function(o){Ne.isUndefined(t[o])?Ne.isUndefined(e[o])||(n[o]=a(void 0,e[o])):n[o]=a(void 0,t[o])})),Ne.forEach(i,(function(o){o in t?n[o]=a(e[o],t[o]):o in e&&(n[o]=a(void 0,e[o]))}));var u=o.concat(r).concat(s).concat(i),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return Ne.forEach(l,c),n},Re=W,Ue=V,Fe=Z,De=function(e){return Ie(e),e.headers=e.headers||{},e.data=Pe(e.data,e.headers,e.transformRequest),e.headers=Le.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Le.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||_e.adapter)(e).then((function(t){return Ie(e),t.data=Pe(t.data,t.headers,e.transformResponse),t}),(function(t){return qe(t)||(Ie(e),t&&t.response&&(t.response.data=Pe(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},Me=Be;function He(e){this.defaults=e,this.interceptors={request:new Fe,response:new Fe}}He.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=Me(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[De,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},He.prototype.getUri=function(e){return e=Me(this.defaults,e),Ue(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},Re.forEach(["delete","get","head","options"],(function(e){He.prototype[e]=function(t,n){return this.request(Me(n||{},{method:e,url:t,data:(n||{}).data}))}})),Re.forEach(["post","put","patch"],(function(e){He.prototype[e]=function(t,n,o){return this.request(Me(o||{},{method:e,url:t,data:n}))}}));var Ge=He;function ze(e){this.message=e}ze.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},ze.prototype.__CANCEL__=!0;var Ke=ze,Je=Ke;function We(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new Je(e),t(n.reason))}))}We.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},We.source=function(){var e;return{token:new We((function(t){e=t})),cancel:e}};var $e=We,Xe=W,Ve=U,Ye=Ge,Qe=Be;function Ze(e){var t=new Ye(e),n=Ve(Ye.prototype.request,t);return Xe.extend(n,Ye.prototype,t),Xe.extend(n,t),n}var et=Ze(Te);et.Axios=Ye,et.create=function(e){return Ze(Qe(et.defaults,e))},et.Cancel=Ke,et.CancelToken=$e,et.isCancel=te,et.all=function(e){return Promise.all(e)},et.spread=function(e){return function(t){return e.apply(null,t)}},et.isAxiosError=function(e){return"object"==typeof e&&!0===e.isAxiosError},R.exports=et,R.exports.default=et;var tt=R.exports;const{IdealPostcodesError:nt}=L,ot=(e,t)=>{return{httpRequest:e,body:t.data,httpStatus:t.status||0,header:(n=t.headers,Object.keys(n).reduce(((e,t)=>{const o=n[t];return"string"==typeof o?e[t]=o:Array.isArray(o)&&(e[t]=o.join(",")),e}),{})),metadata:{response:t}};var n},rt=e=>{const t=new nt({message:"[".concat(e.name,"] ").concat(e.message),httpStatus:0,metadata:{axios:e}});return Promise.reject(t)},st=()=>!0;class it{constructor(){this.Axios=tt.create({validateStatus:st})}requestWithBody(e){const{body:t,method:n,timeout:o,url:r,header:s,query:i}=e;return this.Axios.request({url:r,method:n,headers:s,params:i,data:t,timeout:o}).then((t=>ot(e,t))).catch(rt)}request(e){const{method:t,timeout:n,url:o,header:r,query:s}=e;return this.Axios.request({url:o,method:t,headers:r,params:s,timeout:n}).then((t=>ot(e,t))).catch(rt)}http(e){return void 0!==e.body?this.requestWithBody(e):this.request(e)}}class at extends class{constructor(e){this.config=t(t({},o),e),this.config.header=t(t({},o.header),e.header&&e.header)}url(){const{baseUrl:e,version:t}=this.config;return"".concat(this.protocol(),"://").concat(e,"/").concat(t)}protocol(){return this.config.tls?"https":"http"}}{constructor(e){super(t({agent:new it},e))}}const ct=e=>"string"==typeof e,ut=e=>e.setAttribute("idpc","true"),lt=(e,t)=>ct(e)?t.querySelector(e):e,dt=()=>window.document,ht=e=>ct(e)?dt().querySelector(e):null===e?dt():e,pt=(e,t)=>{const n=e.getAttribute("style");return Object.keys(t).forEach((n=>e.style[n]=t[n])),n},ft=e=>(e.style.display="none",e),mt=e=>(e.style.display="",e),gt=e=>{null!==e&&null!==e.parentNode&&e.parentNode.removeChild(e)},yt=(e,t,n)=>{const o=e.querySelectorAll(t);for(let e=0;e<o.length;e++){const t=o[e],r=t.innerText;if(r&&r.trim()===n)return t}return null},vt=e=>{const t=(e=String(e)).length;let n,o=-1,r="";const s=e.charCodeAt(0);for(;++o<t;)n=e.charCodeAt(o),r+=0!=n?n>=1&&n<=31||127==n||0==o&&n>=48&&n<=57||1==o&&n>=48&&n<=57&&45==s?"\\"+n.toString(16)+" ":(0!=o||1!=t||45!=n)&&(n>=128||45==n||95==n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122)?e.charAt(o):"\\"+e.charAt(o):"ï¿½";return r},bt=(e,t)=>e.dispatchEvent((e=>{let{event:t,bubbles:n=!0,cancelable:o=!0}=e;if("function"==typeof window.Event)return new window.Event(t,{bubbles:n,cancelable:o});const r=document.createEvent("Event");return r.initEvent(t,n,o),r})({event:t})),wt=e=>null!==e&&e instanceof HTMLSelectElement,Et=e=>null!==e&&e instanceof HTMLInputElement,Ct=e=>null!==e&&e instanceof HTMLTextAreaElement,St=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&(Et(e)||Ct(e))&&Ot({e:e,value:t,skipTrigger:n})},At=(e,t)=>null!==t&&null!==e.querySelector('[value="'.concat(t,'"]')),xt=(e,t)=>{const n=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value");if(void 0===n)return;if(void 0===n.set)return;n.set.call(e,t)},Ot=e=>{null!==e.value&&((e=>{let{e:t,value:n,skipTrigger:o}=e;null!==n&&wt(t)&&(xt(t,n),o||bt(t,"select"),bt(t,"change"))})(e),(e=>{let{e:t,value:n,skipTrigger:o}=e;null!==n&&(Et(t)||Ct(t))&&(xt(t,n),o||bt(t,"input"),bt(t,"change"))})(e))},kt=e=>/^GY/.test(e.postcode)?"GG":/^JE/.test(e.postcode)?"JE":null,jt="United Kingdom",Tt="Isle of Man",Lt="England",Pt="Scotland",qt="Northern Ireland",_t="Channel Islands",It=e=>{const t=e.country;if(t===Lt)return jt;if(t===Pt)return jt;if("Wales"===t)return jt;if(t===qt)return jt;if(t===Tt)return Tt;if(t===_t){const t=kt(e);if("GG"===t)return"Guernsey";if("JE"===t)return"Jersey"}return null},Nt=(e,t)=>{if(e){if(wt(e)){const n=(e=>{const t=e.country;return t===Lt||t===Pt||"Wales"===t||t===qt?"GB":t===Tt?"IM":t===_t?kt(e):null})(t);At(e,n)&&Ot({e:e,value:n});const o=It(t);At(e,o)&&Ot({e:e,value:o})}if(Et(e)){const n=It(t);Ot({e:e,value:n})}}};let Bt={};"undefined"!=typeof window&&(window.idpcGlobal?Bt=window.idpcGlobal:window.idpcGlobal=Bt);var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});var Ut=Rt.capitalisePostTown=void 0,Ft=/^(of|le|upon|on|the)$/,Dt=/\w+&\w+/,Mt=function(e){return(e=e.toLowerCase()).match(Ft)?e:e.match(Dt)?e.toUpperCase():e.charAt(0).toUpperCase()+e.slice(1)},Ht=/-/,Gt=/^(in|de|under|upon|y|on|over|the|by)$/,zt=function(e){return null===e.match(Ht)?e:e.split("-").map((function(e){return e.match(Gt)?e.toLowerCase():Mt(e)})).join("-")},Kt=/bo'ness/i,Jt=/bfpo/i,Wt=function(e){return e.match(Kt)?"Bo'Ness":e.match(Jt)?"BFPO":e};Ut=Rt.capitalisePostTown=function(e){return e.split(" ").map(Mt).map(zt).map(Wt).join(" ")};const $t=e=>e.filter((e=>ct(e)?!!e.trim():!!e)).join(", "),Xt=(e,t)=>{const n=e[t];return"number"==typeof n?n.toString():void 0===n?"":n},Vt=(e,t)=>void 0===e[t],Yt=(e,t,n)=>{const[o,r,s]=((e,t)=>{const{line_1:n,line_2:o,line_3:r}=t;return 3===e?[n,o,r]:2===e?[n,$t([o,r]),""]:[$t([n,o,r]),"",""]})((e=>{const{line_2:t,line_3:n}=e;return t?n?3:2:1})(e),t);St(lt(e.line_1||null,n),o),St(lt(e.line_2||null,n),r),St(lt(e.line_3||null,n),s)},Qt=(e,t)=>{const n={};let o;for(o in e){if(!e.hasOwnProperty(o))continue;const r=e[o],s=lt('[name="'.concat(r,'"]'),t);if(s){n[o]=s;continue}const i=lt('[aria-name="'.concat(r,'"]'),t);i&&(n[o]=i)}return n},Zt=(e,t)=>{const n={};if(void 0===e)return e;let o;for(o in e){if(!e.hasOwnProperty(o))continue;const r=e[o];if(!r)continue;const s=yt(t,"label",r),i=lt(s,t);if(!i)continue;const a=i.getAttribute("for");if(a){const e=t.querySelector("#".concat(vt(a)));if(e){n[o]=e;continue}}const c=i.querySelector("input");c&&(n[o]=c)}return n},en=e=>{const{config:n}=e,o=t({},e.address),{scope:r,titleizePostTown:s,populateOrganisation:i,populateCounty:a}=n,c=t(t(t({},(u=e).outputFields),Qt(u.names||{},u.config.scope)),Zt(u.labels||{},u.config.scope));var u;let l;for(l in n.removeOrganisation&&tn(o),s&&(o.post_town=Ut(o.post_town)),Yt(c,o,r),delete o.line_1,delete o.line_2,delete o.line_3,Nt(lt(c.country||null,r),o),delete o.country,!1===i&&delete o.organisation_name,!1===a&&delete o.county,c)if(!Vt(o,l)&&c.hasOwnProperty(l)){const e=c[l];if(!e)continue;St(lt(e,r),Xt(o,l))}},tn=e=>(0===e.organisation_name.length||0===e.line_2.length&&0===e.line_3.length||e.line_1===e.organisation_name&&(e.line_1=e.line_2,e.line_2=e.line_3,e.line_3=""),e),nn={13:"Enter",38:"ArrowUp",40:"ArrowDown",36:"Home",35:"End",27:"Escape",8:"Backspace"},on=["Enter","ArrowUp","ArrowDown","Home","End","Escape","Backspace"],rn=e=>{return e.keyCode?nn[e.keyCode]||null:(t=e.key,-1!==on.indexOf(t)?e.key:null);var t},sn=function(e,t,n){let o,r,s,i,a,c,u=0,l=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");var p,f;function m(t){const n=o,s=r;return o=r=void 0,u=t,i=e.apply(s,n),i}function g(e){return u=e,a=setTimeout(v,t),l?m(e):i}function y(e){const n=e-c;return void 0===c||n>=t||n<0||d&&e-u>=s}function v(){const e=Date.now();if(y(e))return function(e){if(a=void 0,h&&o)return m(e);return o=r=void 0,i}(e);a=setTimeout(v,function(e){const n=e-u,o=t-(e-c);return d?Math.min(o,s-n):o}(e))}function b(){const e=Date.now(),n=y(e);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];if(o=u,r=this,c=e,n){if(void 0===a)return g(c);if(d)return a=setTimeout(v,t),m(c)}return void 0===a&&(a=setTimeout(v,t)),i}return t=+t||0,f=typeof(p=n),!p||"object"!=f&&"function"!=f||(l=!!n.leading,d="maxWait"in n,s=d?Math.max(+n.maxWait||0,t):s,h="trailing"in n?!!n.trailing:h),b.cancel=function(){void 0!==a&&clearTimeout(a),u=0,o=c=r=a=void 0},b.pending=function(){return void 0!==a},b},an=e=>{let{bind:t,interval:n=1e3}=e,o=null;const r=()=>{null!==o&&(window.clearInterval(o),o=null)};return{start:()=>(o=window.setInterval((()=>{try{t()}catch(e){r()}}),n),o),stop:r}},cn=e=>window&&window.MutationObserver&&e.mutationObserver?(e=>{let{bind:t,interval:n=1e3,target:o=window.document,observerConfig:r={subtree:!0,childList:!0,attributes:!0}}=e;const s=new MutationObserver(sn((()=>{try{t()}catch(e){i()}}),n)),i=()=>s.disconnect();return{start:()=>(s.observe(o,r),null),stop:i}})(e):an(e),un=e=>(e.preventDefault&&e.preventDefault(),!1),ln=()=>{},dn=()=>!1,hn=function(e){if("Enter"===rn(e))return e.preventDefault(),this.handleClick(),!1},pn=function(e){return e.preventDefault(),this.options.onButtonTrigger.call(this),this.handleClick(),!1},fn=function(){const e=parseInt(this.select.value,10);isNaN(e)||this.selectAddress(e)},mn={apiKey:"",checkKey:!0,context:"",outputScope:null,onButtonTrigger:ln,onSearchCompleted:ln,onAddressesRetrieved:ln,onAddressSelected:ln,onSelectCreated:ln,onSelectRemoved:ln,onLookupTriggered:ln,shouldLookupTrigger:()=>!0,onSearchError:ln,onLoaded:ln,onFailedCheck:ln,onRemove:ln,onAddressPopulated:ln,onUnhide:ln,input:null,inputId:null,inputClass:"idpc-input",inputAriaLabel:"Search a postcode to retrieve your address",placeholder:"Search your postcode",button:null,buttonId:null,buttonLabel:"Find my Address",buttonClass:"idpc-button",selectContainer:null,selectId:null,selectClass:"idpc-select",selectContainerId:null,selectContainerClass:"idpc-select-container",selectAriaLabel:"Select your address",unhide:null,unhideClass:"idpc-unhide",message:null,messageId:null,messageClass:"idpc-error",msgSelect:"Please select your address",msgDisabled:"Finding addresses...",msgNotFound:"Your postcode could not be found. Please type in your address",msgAddressNotFound:"We could not find a match for your address. Please type in your address",msgError:"Sorry, we weren't able to get the address you were looking for. Please type in your address",msgUnhide:"Enter address manually",cooloff:500,removeOrganisation:!1,selectSinglePremise:!1,titleizePostTown:!0,postcodeSearchFormatter:e=>{const t=[e.line_1];return""!==e.line_2&&t.push(e.line_2),t.join(" ")},addressSearchFormatter:e=>{const t=[e.line_1];return""!==e.line_2&&t.push(e.line_2),t.push(e.post_town),t.push(e.postcode_outward),t.join(", ")},outputFields:{},strictlyPostcodes:!0,limit:10,inputStyle:{},buttonStyle:{},messageStyle:{},selectStyle:{},contextStyle:{},hide:[],autocomplete:"none",populateCounty:!0,populateOrganisation:!0};class gn{constructor(e){var n;this.prevContext=null,this.options=t(t(t({},{scope:window.document,document:window.document}),mn),e),this.client=new at(t(t({},this.options),{},{api_key:this.options.apiKey})),this.scope=ht(this.options.scope),this.document=(n=this.scope)instanceof Document?n:n.ownerDocument?n.ownerDocument:dt(),this.outputScope=this.findOrCreate(this.options.outputScope,(()=>this.scope)),this.data=[],this.lastLookup="",this.context=this.findOrCreate(this.options.context),this.prevContext=pt(this.context,this.options.contextStyle),this.keypress=hn.bind(this),this.click=pn.bind(this),this.selectEvent=fn.bind(this),this.unhideEvent=this.unhideFields.bind(this),this.input=this.createInput(),this.button=this.createButton(),this.message=this.createMessage(),this.select=this.createSelect(),this.selectContainer=this.createContainer(),this.unhide=this.createUnhide(),this.init()}findOrCreate(e,t){return ct(e)?this.scope.querySelector(e):t&&null===e?t():e}createUnhide(){const e=this.findOrCreate(this.options.unhide,(()=>{const e=this.document.createElement("p");return e.innerText=this.options.msgUnhide,e.setAttribute("role","button"),e.setAttribute("tabindex","0"),this.options.unhideClass&&(e.className=this.options.unhideClass),e}));return e.addEventListener("click",this.unhideEvent),e}unmountUnhide(){this.unhide.removeEventListener("click",this.unhideEvent),!this.options.unhide&&this.options.hide.length&&gt(this.unhide)}createContainer(){return this.findOrCreate(this.options.selectContainer,(()=>{const e=this.options,t=this.document.createElement("div");return e.selectContainerId&&(t.id=e.selectContainerId),e.selectContainerClass&&(t.className=e.selectContainerClass),t.setAttribute("aria-live","polite"),ft(t),t}))}unmountContainer(){gt(this.selectContainer)}createInput(){const e=this.findOrCreate(this.options.input,(()=>{const e=this.document.createElement("input"),t=this.options;return e.type="text",t.inputId&&(e.id=t.inputId),t.inputClass&&(e.className=t.inputClass),t.placeholder&&(e.placeholder=t.placeholder),t.inputAriaLabel&&e.setAttribute("aria-label",t.inputAriaLabel),t.autocomplete&&e.setAttribute("autocomplete",t.autocomplete),pt(e,this.options.inputStyle),e}));return e.addEventListener("keypress",this.keypress),e.addEventListener("submit",dn),e}unmountInput(){this.input.removeEventListener("keypress",this.keypress),this.input.removeEventListener("submit",dn),null===this.options.input&&gt(this.input)}createButton(){const e=this.findOrCreate(this.options.button,(()=>{const e=this.document.createElement("button"),t=this.options;return e.type="button",t.buttonLabel&&(e.innerText=t.buttonLabel),t.buttonId&&(e.id=t.buttonId),t.buttonClass&&(e.className=t.buttonClass),pt(e,this.options.buttonStyle),e.onclick=un,e}));return e.addEventListener("submit",dn),e.addEventListener("click",this.click),e}unmountButton(){this.button.removeEventListener("submit",dn),this.button.removeEventListener("click",this.click),null===this.options.button&&gt(this.button)}createMessage(){return this.findOrCreate(this.options.message,(()=>{const e=this.document.createElement("p"),t=this.options;return t.messageClass&&(e.className=t.messageClass),t.messageId&&(e.id=t.messageId),e.setAttribute("role","alert"),pt(e,this.options.messageStyle),ft(e),e}))}unmountMessage(){null===this.options.message&&gt(this.message)}createSelect(){const e=this.document.createElement("select"),t=this.options;return t.selectId&&(e.id=t.selectId),t.selectClass&&(e.className=t.selectClass),pt(e,this.options.selectStyle),t.selectAriaLabel&&e.setAttribute("aria-label",t.selectAriaLabel),e.addEventListener("change",this.selectEvent),e}mountSelect(e){e&&(this.data=e),(e=>{let t;for(t=e.options.length-1;t>=0;t--)e.remove(t)})(this.select),this.select.appendChild(this.createOption("ideal",this.options.msgSelect));for(let e=0;e<this.data.length;e+=1)this.select.appendChild(this.createOption(e.toString(),this.formatAddress(this.data[e])));this.selectContainer.appendChild(this.select),mt(this.selectContainer),this.options.onSelectCreated.call(this,this.select)}unmountSelect(){gt(this.select),ft(this.selectContainer),this.options.onSelectRemoved.call(this)}selectAddress(e){const t=this.data[e];t&&(this.populateAddress(t),this.options.onAddressSelected.call(this,t))}handleClick(){if(!this.options.shouldLookupTrigger.call(this))return!1;this.options.onLookupTriggered.call(this);const e=this.input.value;return this.lastLookup===e||(this.lastLookup=e,this.reset(),this.disableButton(),this.executeSearch(e)),!1}disableButton(e){this.options.button||(this.button.setAttribute("disabled","true"),this.button.innerText=e||this.options.msgDisabled)}enableButton(){this.options.button||(this.button.removeAttribute("disabled"),this.button.innerText=this.options.buttonLabel)}enableLookup(){if(this.options.button)return;const{cooloff:e}=this.options;if(0===e)return this.enableButton();setTimeout((()=>this.enableButton()),e)}reset(){this.unmountSelect(),this.hideMessage()}removeAll(){var e,t;this.unmountInput(),this.unmountButton(),this.unmountContainer(),this.unmountMessage(),this.unmountUnhide(),e=this.context,t=this.prevContext,e.setAttribute("style",t||""),this.options.onRemove.call(this)}notFoundMessage(){return this.options.strictlyPostcodes?this.options.msgNotFound:this.options.msgAddressNotFound}executeSearch(e){this.enableLookup();(this.options.strictlyPostcodes?this.searchPostcode(e):this.searchAddress(e)).then((t=>(this.options.onSearchCompleted.call(this,null,t),0===t.length?this.setMessage(this.notFoundMessage()):(this.lastLookup=e,this.data=t,this.options.onAddressesRetrieved.call(this,t),this.options.selectSinglePremise&&1===t.length?this.selectAddress(0):void this.mountSelect(t))))).catch((e=>{this.setMessage(this.options.msgError),this.options.onSearchCompleted.call(this,null,[]),this.options.onSearchError.call(this,e)}))}searchPostcode(e){return I({client:this.client,postcode:e})}searchAddress(e){return(e=>{const t={},n={query:e.query},{client:o}=e;l({client:o,header:t,options:e}),h({header:t,options:e}),p({query:n,options:e}),f({client:o,query:n,options:e}),(e=>{let{query:t,options:n}=e;const{page:o,limit:r}=n;void 0!==o&&(t.page=o.toString()),void 0!==r&&(t.limit=r.toString())})({query:n,options:e});const r={header:t,query:n};return void 0!==e.timeout&&(r.timeout=e.timeout),_(o,r).then((e=>e.body.result.hits))})({client:this.client,query:e,limit:this.options.limit})}formatAddress(e){return(this.options.strictlyPostcodes?this.options.postcodeSearchFormatter:this.options.addressSearchFormatter)(e)}createOption(e,t){const n=this.document.createElement("option");return n.text=t,n.value=e,n}setMessage(e){if(this.message){if(void 0===e)return this.hideMessage();mt(this.message),this.message.innerText=e}}hideMessage(){this.message&&(this.message.innerText="",ft(this.message))}init(){const e=()=>{this.render(),this.hideFields(),this.options.onLoaded.call(this)};if(!this.options.checkKey)return e();B({client:this.client}).then((t=>{let{available:n}=t;return n?e():Promise.reject("Key not available")})).catch((e=>{this.options.onFailedCheck&&this.options.onFailedCheck(e)}))}populateAddress(e){this.unhideFields();const n=this.options.outputFields,o=t(t({},this.options),{},{scope:this.outputScope});en({outputFields:n,address:e,config:o}),this.options.onAddressPopulated.call(this,e)}hiddenFields(){return this.options.hide.map((e=>{return ct(e)?(t=this.scope,(n=e)?t.querySelector(n):null):e;var t,n})).filter((e=>null!==e))}hideFields(){this.hiddenFields().forEach(ft)}unhideFields(){this.hiddenFields().forEach(mt),this.options.onUnhide.call(this)}render(){this.context.innerHTML="",this.options.input||this.context.appendChild(this.input),this.options.button||this.context.appendChild(this.button),this.options.selectContainer||this.context.appendChild(this.selectContainer),this.options.message||this.context.appendChild(this.message),!this.options.unhide&&this.options.hide.length&&this.context.appendChild(this.unhide)}}const yn=()=>!0,vn=()=>{},bn=e=>{const t=ht(e.scope||null).querySelectorAll(e.anchor||e.context||e.scope);return(n=t,Array.prototype.slice.call(n)).filter((e=>!("true"===e.getAttribute("idpc"))));var n},wn=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{pageTest:o=yn,onError:r=vn,onBindAttempt:s=vn,onBind:i=vn,anchor:a,onAnchorFound:c=vn,getScope:u=ht}=n;let l;const d=()=>{try{s(e),bn(t({anchor:a},e)).forEach((t=>{if(!o())return;const n=u(t);c({anchor:t,scope:n,config:e}),l=new gn(e),ut(t),i(l)}))}catch(e){r(e)}},{start:h,stop:p}=cn({config:e,bind:d});return h(),{start:h,stop:p,controller:l}},En=[],Cn={controllers:En,setup:e=>{const t=new gn(e);return En.push(t),t},Controller:gn,defaults:mn,watch:wn};export{gn as Controller,Cn as PostcodeLookup,wn as watch};
